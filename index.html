<head>
    <script src="./resources/js/polygen.js"></script>
    <script src="./resources/js/functions.js"></script>
    <link rel="stylesheet" type="text/css" href="./resources/style.css">
    <title>Human Swarm</title>
</head>

<body>
    <form name="form">
        <select id="sidesmenu">
            <option value="">Select a shape by number of elements</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
        </select>
    </form>
    <canvas id="canvas" width="512" height="512"></canvas>
    <button id="gen-button">Generate game</button>

    <script id="shapes">
        // setup canvas
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
        canvas.style.display= 'block';
        canvas.style.height = 512;
        canvas.style.width = 512;
        // initialize things for shape drawing
        var shapeRadius = 150;
        var centerX = canvas.width / 2;
        var centerY = canvas.height / 2;
        var sidesCount;
        // vars for each function allow us to use clearInterval(var) to stop the function
        var puckLineInterval;
        var puckInterval;
        var countDown;


        // when a menu option is selected
        document.getElementById('gen-button').addEventListener("click", function(){ 
            sidesCount = document.getElementById('sidesmenu').value; // get menu selection
            PolyGen(sidesCount, document.querySelector("canvas"), 0, shapeRadius, 5, "#222", 0, 0);
            clearInterval(countDown);
            countDown();
            clearInterval(puckLineInterval);
            clearInterval(puckInterval);
            setInterval(drawMagnet,10);
            context.clearRect(midX-30, midY-250,60,85);
            if(sidesCount != 2){
                clearInterval(puckLineInterval);
                puckInterval = setInterval(drawPuck,10); // draw puck every 10 ms
                // draw game circle
                context.arc(centerX, centerY, shapeRadius, 0, 2 * Math.PI, false); 
                context.lineWidth = 1;
                context.stroke();
            } else { puckLineInterval = setInterval(drawPuckLine,10); }
            document.getElementById('magnet').style.visibility = 'visible';
            document.getElementById('puck').style.visibility = 'visible';
        });
    </script>


    <img id="magnet" src="./resources/magnet.png"/>
    <img id="puck" src="./resources/puck.png"/>
    <script id="mouse">
        var midX = (canvas.width/2); // get coordinates of middle of the canvas
        var midY = (canvas.height/2);
        var mousePos = {x: midX, y: midY};
        var puckPos = {x: midX, y: midY};
        function getMousePos(canvas, evt) {
            var rect = canvas.getBoundingClientRect();
            return { x: evt.clientX - rect.left, y: evt.clientY - rect.top }
        }
        // every time 'mousemove' event occurs, call getMousePos
        canvas.addEventListener('mousemove', function(evt) {mousePos = getMousePos(canvas, evt);}, false);     
    </script>
</body>